<!--
Sync Impact Report:
- Version change: 1.0.0 → 2.0.0
- Modified principles: Phase-3 Purpose → Phase-4 Purpose (expanded scope)
- Added sections: Infrastructure-Only Mandate, Containerization Constitution, Kubernetes Deployment Law, Helm Chart Governance, AI-Assisted DevOps Law, Environment & Secrets Law, Validation & Success Criteria, Agent Authority & Responsibility
- Templates requiring updates: ✅ .specify/templates/spec-template.md, ✅ .specify/templates/plan-template.md, ✅ .specify/templates/tasks-template.md
- Follow-up TODOs: None
-->

# Hackathon-2 – Phase-4 Constitution

## Core Principles

### Authority & Supremacy
This constitution is the highest governing document for Hackathon-2 Phase-4. It supersedes all ad-hoc instructions, all undocumented assumptions, and any AI-generated code that violates it. All specifications, plans, tasks, and implementations must comply with this constitution. Violation of this constitution invalidates the implementation.

### Phase-3 Preservation Principle (Critical)
Phase-4 is NOT a rewrite. Everything from Phase-3 remains intact, unchanged, and authoritative, including frontend structure, backend APIs, authentication flow, database schema, task CRUD logic, AI chatbot functionality, MCP tools, environment variable usage, and folder hierarchy. Refactoring Phase-3 code, renaming Phase-3 routes or models, replacing existing UI or APIs, and changing auth behavior are explicitly forbidden. Phase-4 extends Phase-3 — it does not modify it.

### Phase-4 Purpose
Phase-4 introduces infrastructure and deployment layers that containerize and orchestrate the existing Phase-3 application using Docker, Kubernetes, and Helm. Phase-4 preserves all application functionality while enabling containerized deployment to local Minikube clusters. The infrastructure layer must be stateless, scalable, and maintain all existing application behaviors.

### Architectural Doctrine (Non-Negotiable)
Phase-4 architecture is infrastructure-focused and deployment-driven. Core principles include: no modification of application logic, all infrastructure code follows containerization best practices, Kubernetes resources maintain statelessness of application, all configuration managed through environment variables and ConfigMaps/Secrets, and deployments remain reproducible and version-controlled.

### Approved Technology Stack
Infrastructure uses Docker for containerization, Minikube for local Kubernetes, Helm for packaging and deployment, kubectl for cluster management, and kubectl-ai for AI-assisted operations. All application technology stacks from Phase-3 remain unchanged (Next.js frontend, FastAPI backend, SQLModel, Neon PostgreSQL, Better Auth, OpenAI Agents SDK, MCP SDK).

### Folder & Project Structure Authority
Phase-4 folder is created by copying Phase-3 entirely. Phase-4 additions must be clearly isolated in new directories: /docker, /helm, /k8s, /infra, /scripts. Phase-4 infrastructure files must not be mixed with application code. The structure follows: Hackathon-2/Phase-3/ (original, untouched), Hackathon-4/ (copied from Phase-3 with infrastructure additions).

### Infrastructure-Only Mandate
Phase-4 concerns only: Docker containerization, Kubernetes deployment (Minikube), Helm chart packaging, AI-assisted DevOps tooling. Explicitly forbidden: Changing API routes, modifying database schema, editing agent logic, altering authentication flow, optimizing business logic, or touching application code unnecessarily.

### Containerization Constitution (Docker + Gordon)
Frontend and backend must be containerized separately. Docker AI Agent (Gordon) must be used when available. If Gordon is unavailable, standard Docker CLI commands may be generated by Claude Code. Docker images must be development-friendly, expose required ports only, accept configuration via environment variables, with no multi-stage optimization required — clarity > performance.

### Kubernetes Deployment Law (Minikube)
Deployment target is local Minikube only. Kubernetes resources must include: Deployments, Services, ConfigMaps, Secrets. No cloud-specific resources are allowed. Resource limits should be reasonable but not over-engineered. Kubernetes pods must remain stateless; persistence stays in the database layer as defined in Phase-3.

### Helm Chart Governance
Helm charts are mandatory for deployment. Charts must be configurable via values.yaml, support replica scaling, separate frontend and backend concerns. Helm charts must reflect the existing Phase-3 architecture exactly. Helm is a packaging layer, not a redesign tool.

### AI-Assisted DevOps Law
kubectl-ai is used for: Deployment, Scaling, Debugging, Status inspection. Kagent is used for: Cluster health analysis, Resource optimization suggestions, Learning-oriented diagnostics. AI tools assist operations — they do not replace specs.

### Environment & Secrets Law
Environment variables from Phase-3 must remain valid. Secrets (OpenAI API key, auth secrets) must never be hardcoded, be injected via Kubernetes Secrets, with local development assumptions allowed. .env.example must remain the source of truth.

### Development Discipline (Standardized)
All development follows the SDD methodology with strict adherence to specifications, plans, and tasks. Every change must have a corresponding task, and all implementation must follow the red-green-refactor cycle.

## Additional Constraints

Technology Stack Requirements:
- Infrastructure: Docker, Kubernetes (Minikube), Helm 3.x, kubectl-ai, Kagent
- Application (preserved from Phase-3): Next.js 14+, TypeScript, Tailwind CSS, OpenAI ChatKit, Python 3.11+, FastAPI, SQLModel, Neon PostgreSQL, OpenAI Agents SDK, MCP Specification 1.0+, Better Auth v1.x
- Containerization: Multi-stage builds (optional), environment variable configuration, exposed port management

Security Standards:
- No direct database access by AI agents (preserved from Phase-3)
- Environment variables for all secrets (preserved from Phase-3)
- JWT-based authentication maintained (preserved from Phase-3)
- Kubernetes Secrets for secret management
- RBAC configuration for cluster access
- Image scanning for container security
- Network policies for pod isolation

Performance Standards:
- Statelessness required for scalability (preserved from Phase-3)
- Kubernetes resource limits and requests properly configured
- Horizontal Pod Autoscaling enabled when appropriate
- Efficient container image sizes
- Proper health checks and readiness probes

## Development Workflow

Specification Process:
- All features must have a spec.md file
- Specifications must align with Phase-3 functionality
- Infrastructure specifications must define required containers, services, and configurations
- User stories clearly defined before implementation
- Acceptance criteria specified for each feature

Planning Process:
- Architectural decisions documented in plan.md
- Infrastructure architecture decisions must be captured
- Task breakdown follows tasks.md format
- Dependencies explicitly identified
- Risk assessment included in planning
- Kubernetes resource allocation planned appropriately

Task Management:
- Tasks must be testable and verifiable
- Each task addresses a single responsibility
- Infrastructure tasks separated from application tasks
- Tasks must have clear acceptance criteria
- Unit and integration tests required for all code
- Deployment validation tests included for infrastructure tasks

Quality Assurance:
- Code reviews required for all PRs
- Automated testing must pass before merging
- Static analysis tools configured and passing
- Security scanning integrated into pipeline
- Infrastructure scanning for misconfigurations
- Deployment validation against success criteria

## Governance

This constitution is the highest authority for the Hackathon-2 Phase-4 project. All team members must adhere to these principles. Changes to this constitution require explicit approval from project leadership and must follow the established amendment procedure. All implementations, specifications, and designs must be validated against these principles. Compliance is verified through code reviews, automated checks, and manual audits. Infrastructure implementations must be validated against the preservation of Phase-3 functionality.

Validation & Success Criteria:
Phase-4 is considered successful only if: Minikube cluster runs successfully, Frontend is reachable via Kubernetes Service, Backend API responds correctly, Chatbot functionality works end-to-end, Pods survive restarts without data loss, kubectl-ai and kagent can inspect the cluster.

Agent Authority & Responsibility:
Each agent operates only within its assigned domain:
- Infra Spec Agent: Infrastructure definition
- Dockerization Agent: Container design
- Helm Architect Agent: Helm structure
- K8s Ops Agent: Deployment & scaling
- Cluster Intel Agent: Health & optimization
- Env & Secrets Agent: Configuration safety
- Deployment Validation Agent: Verification
- Agentic Orchestrator: Workflow enforcement

No agent may: Skip steps, Override specs, Implement without approval.

Amendment Process:
1. Proposed changes must be documented with rationale
2. Team review and discussion required
3. Approval from project leadership needed
4. Updated constitution must be communicated to all team members
5. Dependent artifacts must be updated accordingly

Versioning Policy:
- Major version increments for fundamental principle changes
- Minor version increments for addition of new principles
- Patch version increments for clarifications and corrections

Compliance Review:
- Regular reviews to ensure adherence to principles
- Quarterly assessment of constitution effectiveness
- Feedback loop for continuous improvement
- Enforcement mechanisms for violations

**Version**: 2.0.0 | **Ratified**: 2026-02-07 | **Last Amended**: 2026-02-08